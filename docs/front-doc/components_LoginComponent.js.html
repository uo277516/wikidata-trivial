<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/LoginComponent.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/LoginComponent.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
import React, { useEffect, useState } from 'react';
import { Layout, Typography, Button, Image, notification } from 'antd';
import { headerStyle, contentStyle, footerStyle} from '../styles/appStyle.js';
import logo from '../logo.png'; 
import CategorySelectionPage from './CategorySelectionPage.js';
import { LoginOutlined } from '@ant-design/icons';
import MenuComponent from './MenuComponent.js';
import { useTranslation } from 'react-i18next';
import '../styles/styles.css'; 


const { Title, Paragraph, Link} = Typography;
const { Header, Content, Footer, Sider } = Layout;

/**
 * Login component for the web application.
 * @component
 * @returns {React.JSX.Element} Rendered component.
 */
const LoginComponent = () => {

  const { t } = useTranslation();

  const [isLoggedIn, setIsLoggedIn] = useState(false);

  /**
   * Lifecycle hook for checking user authentication on component mount.
   * @function useEffect
   * @returns {void}
   */
  useEffect(() => {
    checkAuthentication();
  }, []);


  /**
   * Handles login by redirecting the user to the authentication URL and
   * getting the user's data.
   * @function handleLogin
   * @async
   * @returns {void}
   */
  const handleLogin = async () => {
    console.log("User logged in");
    const redirectUrl = process.env.REACT_APP_BACKEND_BASE_URL + "/login";
    window.location.href = redirectUrl;
    const userData = await fetchUserData(); //user data

    if (userData===null) {
      notification.error({message: t('login.errorOAuth'), description: t('login.descErrorOAuth'), placement: 'top'});
    } else {
      localStorage.setItem('user', JSON.stringify(userData)); //save data in localStorage
    }
  };


  /**
   * Verifies user authentication by checking if there is user data in localStorage.
   * @function checkAuthentication
   * @async
   * @returns {Promise&lt;Void>}
   */
  const checkAuthentication = async () => {
    if (localStorage.getItem("user")) {
      setIsLoggedIn(true);
    } else {
      setIsLoggedIn(false);
    }
  };
  

  /**
   * Obtains the user data from the backend after authentication.
   * @function fetchUserData
   * @async
   * @returns {Object|null} The user data or null on error.
   */
  const fetchUserData = async () => {
    try {
      const response = await fetch(process.env.REACT_APP_BACKEND_BASE_URL + "/data.json");
      if (response.ok) {
        return await response.json();
      } else {
        console.error('Error fetching user data', response.statusText);
        return null;
      }
    } catch (error) {
      console.error('Error fetching the data of the user', error);
      return null;
    }
  };
  
  

  return (
    &lt;>
      {isLoggedIn ? (
        &lt;CategorySelectionPage />
      ) : (
        &lt;Layout style={{ minHeight: "100vh" }}>
          &lt;MenuComponent user={null} mode='horizontal'>&lt;/MenuComponent>
          &lt;Header style={headerStyle}>
            &lt;Layout id='header' style={{ display: 'flex', alignItems: 'center', backgroundColor: 'white'}}>
              &lt;Sider style={{flex:1, width: '20%', textAlign: 'center', lineHeight: '120px', color: '#fff', backgroundColor: 'white', paddingTop: '20px' }}>
                &lt;Image
                  width={200}
                  src={logo}
                  style={{ paddingLeft: '10px',marginBottom: '20px' }}
                  alt='Logo image'
                />
              &lt;/Sider>
                &lt;Content id='content' style={{ flex: 2, textAlign: 'left', paddingLeft: '20px', color: 'black', backgroundColor: 'white'}}>
                  &lt;Title level={1} style={{ marginTop: '20px', fontWeight: 'bold' }}>Wiki Trivial&lt;/Title>
                  &lt;Title level={2} style={{ marginTop: '5px'}}>{t('login.title')}&lt;/Title>
                &lt;/Content>
            &lt;/Layout>
          &lt;/Header>
          &lt;Content style={contentStyle}>
            &lt;Title level={1} style={{ color: '#004aad', margin: '0 auto' }}>{t('login.login')}&lt;/Title>
            &lt;Paragraph style={{ fontSize: "20px", marginTop: '20px' }}> 
                  {t('login.info1')}
                  &lt;Link href="https://www.wikidata.org/?uselang=es" target="_blank" style={{ fontSize: "20px" }}>Wikidata&lt;/Link>
                  {t('login.info2')}
            &lt;/Paragraph>
            &lt;Button
              type="primary"
              size="large"
              htmlType="submit"
              onClick={() => handleLogin()}
              icon={&lt;LoginOutlined/>}
              style={{ position: 'relative', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', width: '200px' }}
              >
              {t('login.log_in')}
            &lt;/Button>
          &lt;/Content>
          &lt;Footer style={footerStyle}> {t('footer.info')}&lt;a href="https://www.icons8.com" target="_blank" rel="noopener noreferrer" style={{ color: 'white', textDecoration: 'underline' }}>Icons8&lt;/a>&lt;/Footer>
        &lt;/Layout>
      )}
    &lt;/>
  );  
};

export default LoginComponent;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#CategorySelectionPage">CategorySelectionPage</a></li><li><a href="global.html#LoginComponent">LoginComponent</a></li><li><a href="global.html#MenuComponent">MenuComponent</a></li><li><a href="global.html#PrincipalScreen">PrincipalScreen</a></li><li><a href="global.html#QuestionCard">QuestionCard</a></li><li><a href="global.html#TableComponent">TableComponent</a></li><li><a href="global.html#asyncTestFunction">asyncTestFunction</a></li><li><a href="global.html#cancel">cancel</a></li><li><a href="global.html#changeLanguage">changeLanguage</a></li><li><a href="global.html#checkAuthentication">checkAuthentication</a></li><li><a href="global.html#checkProperties">checkProperties</a></li><li><a href="global.html#checkStreak">checkStreak</a></li><li><a href="global.html#createQuestions">createQuestions</a></li><li><a href="global.html#editEntity">editEntity</a></li><li><a href="global.html#fetchData">fetchData</a></li><li><a href="global.html#fetchProperties">fetchProperties</a></li><li><a href="global.html#fetchQuestions">fetchQuestions</a></li><li><a href="global.html#fetchQuestionsFootballers">fetchQuestionsFootballers</a></li><li><a href="global.html#fetchQuestionsGroups">fetchQuestionsGroups</a></li><li><a href="global.html#fetchQuestionsResearchers">fetchQuestionsResearchers</a></li><li><a href="global.html#fetchStreaks">fetchStreaks</a></li><li><a href="global.html#fetchUserData">fetchUserData</a></li><li><a href="global.html#filterStreaks">filterStreaks</a></li><li><a href="global.html#footballerRelations">footballerRelations</a></li><li><a href="global.html#funcProperties">funcProperties</a></li><li><a href="global.html#generateQuestions">generateQuestions</a></li><li><a href="global.html#groupRelations">groupRelations</a></li><li><a href="global.html#handleCategoryChange">handleCategoryChange</a></li><li><a href="global.html#handleGiveUp">handleGiveUp</a></li><li><a href="global.html#handleLoadingState">handleLoadingState</a></li><li><a href="global.html#handleLogin">handleLogin</a></li><li><a href="global.html#handleRestart">handleRestart</a></li><li><a href="global.html#handleSegmentedChange">handleSegmentedChange</a></li><li><a href="global.html#handleSend">handleSend</a></li><li><a href="global.html#handleSendButton">handleSendButton</a></li><li><a href="global.html#handleSendSameEntityButton">handleSendSameEntityButton</a></li><li><a href="global.html#handleStartGame">handleStartGame</a></li><li><a href="global.html#log">log</a></li><li><a href="global.html#ok">ok</a></li><li><a href="global.html#openPop">openPop</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#researcherRelations">researcherRelations</a></li><li><a href="global.html#saveStreak">saveStreak</a></li><li><a href="global.html#setSelCategory">setSelCategory</a></li><li><a href="global.html#useEffect">useEffect</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Thu Jun 20 2024 23:16:30 GMT+0200 (hora de verano de Europa central)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
